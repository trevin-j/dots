####################
###     VARS     ###
####################
$terminal = foot
$file_manager = thunar
$menu = tlgui launch
$browser = firefox

cursor {
    no_hardware_cursors = true
}

####################
### KEYBINDINGS  ###
####################

# =========================
# Modifier Rationale
# =========================

# main_mod — Intent / Navigation
# This modifier is used for fast, safe, top-level actions.
# It answers the question:
#   “What do I want to go to, focus, or invoke right now?”
#
# Rules:
# - Must be safe to press repeatedly
# - Must not permanently change layout or window state
# - No destructive actions
#
# Typical uses:
# - Focus windows (directional or vim-style)
# - Switch workspaces (numbers, relative navigation)
# - Toggle visibility (special workspaces, panels)
# - Launch most-used applications
# - Enter leader/submaps
#
$main_mod = SUPER


# mut_mod — Mutation / Acting-on-target
# This modifier alters the primary action to modify state instead of navigating.
# It answers the question:
#   “Do I want to change reality instead of just looking?”
#
# Rules:
# - Must modify the same target as main_mod
# - Must never introduce a brand-new action
# - Same key, same direction, same object — just destructive
#
# Typical uses:
# - Focus window → move window
# - Go to workspace → send window
# - Toggle visibility → move window into/out of that space
#
$mut_mod = SHIFT


# scope_mod — Scope / Level Shift
# This modifier changes the level at which an action operates.
# It answers the question:
#   “Am I acting at a higher scope than windows?”
#
# Rules:
# - Must not introduce new concepts
# - Changes the level, not the intent
# - Often composes cleanly with mut_mod
#
# Typical scope shifts:
# - Window → workspace
# - Workspace → monitor
# - Local → global
#
# Examples:
# - main_mod + H           → focus window left
# - main_mod + scope_mod + H → switch workspace left
# - main_mod + scope_mod + mut_mod + H → move window to workspace left
#
$scope_mod = CTRL


# sys_mod — System / Layout / WM Behavior
# This modifier is reserved for actions that change how the window manager behaves.
# It answers the question:
#   “Am I changing layout, geometry, or WM state?”
#
# Rules:
# - Never used for navigation or focus
# - Used sparingly and intentionally
# - Should not conflict with muscle-memory movement keys
#
# Typical uses:
# - Resize windows
# - Change layouts or splits
# - Toggle fullscreen, floating, or WM modes
#
$sys_mod = ALT

# leader_key — Leader / Command Mode Trigger
# This variable represents the leader *key only*, not a modifier.
# The leader system is activated by pressing:
#   mainMod + leader_key
#
# The leader key itself must NOT include mainMod.
# Think of it as the “character” that enters command mode, not the full chord.
#
# The leader key is used to enter submaps and command-style menus.
# It answers the question:
#   “I know the action I want, not the spatial target.”
#
# Rules:
# - Leader actions are non-spatial and mnemonic
# - Leader bindings may be multi-step or hierarchical
# - Leader bindings should not be latency-critical
#
# Typical uses:
# - Application launchers
# - Screenshots, dictation, emoji pickers
# - System actions (lock, logout, suspend, reload)
# - Layout or monitor submenus
# - Rare or high-cognitive-load actions
#
# Example:
#   bind = $mainMod, $leader_key, ...
#
$leader_key = SPACE

# =========================
# Binding Decision Rules
# =========================
#
# When creating a new keybind, follow this procedure strictly:
#
# 1. Identify the target.
#    - Window, workspace, monitor, system, or command?
#    → This determines main_mod vs leader.
#
# 2. Is the action safe and non-destructive?
#    - Yes → main_mod allowed
#    - No  → mutMod or leader required
#
# 3. Does this action modify an existing main_mod action?
#    - Yes → add mutMod
#    - No  → it does not belong on mutMod
#
# 4. Does this action operate at a higher level than windows?
#    - Yes → add scope_mod
#
# 5. Does this action change WM behavior, layout, or geometry?
#    - Yes → use sys_mod
#
# 6. Is this a tool, command, or non-spatial action?
#    - Yes → use leader/submap
#
# If more than one answer applies, the binding is incorrectly designed.
# Fix the concept before adding the bind.
#
# Leader key is very useful, utilize it.

# =========================
# Binds
# =========================

# Hardware/Mouse
#-----------------------
# This is binds for hardware stuff like volume, brightness, mouse, etc.

# Brightness
bindel = , XF86MonBrightnessDown, exec, brightnessctl set 10%-
bindel = , XF86MonBrightnessUp, exec, brightnessctl set +10%
# Volume
bindel = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle

# Core Navigation
#-----------------------

# hjkl for window focus
bind = $main_mod, H, movefocus, l
bind = $main_mod, L, movefocus, r
bind = $main_mod, K, movefocus, u
bind = $main_mod, J, movefocus, d
# Also arrow keys
bind = $main_mod, left, movefocus, l
bind = $main_mod, right, movefocus, r
bind = $main_mod, up, movefocus, u
bind = $main_mod, down, movefocus, d

# Focus workspaces with nums
bind = $main_mod, 1, workspace, 1
bind = $main_mod, 2, workspace, 2
bind = $main_mod, 3, workspace, 3
bind = $main_mod, 4, workspace, 4
bind = $main_mod, 5, workspace, 5
bind = $main_mod, 6, workspace, 6
bind = $main_mod, 7, workspace, 7
bind = $main_mod, 8, workspace, 8
bind = $main_mod, 9, workspace, 9
bind = $main_mod, 0, workspace, 10

# Scroll existing workspaces with mouse
bind = $main_mod, mouse_down, workspace, e-1
bind = $main_mod, mouse_up, workspace, e+1

# Go to next empty workspace
bind = $main_mod, W, workspace, empty

# Toggle special terminal workspace
bind = $main_mod, T, togglespecialworkspace, term
workspace = special:term, on-created-empty:$terminal, gapsout:150 30 00 30, gapsin:1

# Go to game workspace
bind = $main_mod, G, workspace, name:Game

# Window Mutation
#-----------------------

# Move windows with shift + hjkl
bind = $main_mod $mut_mod, left, movewindow, l
bind = $main_mod $mut_mod, right, movewindow, r
bind = $main_mod $mut_mod, up, movewindow, u
bind = $main_mod $mut_mod, down, movewindow, d
# Same with arrow keys
bind = $main_mod $mut_mod, L, movewindow, r
bind = $main_mod $mut_mod, K, movewindow, u
bind = $main_mod $mut_mod, J, movewindow, d
bind = $main_mod $mut_mod, H, movewindow, l

# Move active window to a workspace with main_mod + $mut_mod + [0-9]
bind = $main_mod $mut_mod, 1, movetoworkspace, 1
bind = $main_mod $mut_mod, 2, movetoworkspace, 2
bind = $main_mod $mut_mod, 3, movetoworkspace, 3
bind = $main_mod $mut_mod, 4, movetoworkspace, 4
bind = $main_mod $mut_mod, 5, movetoworkspace, 5
bind = $main_mod $mut_mod, 6, movetoworkspace, 6
bind = $main_mod $mut_mod, 7, movetoworkspace, 7
bind = $main_mod $mut_mod, 8, movetoworkspace, 8
bind = $main_mod $mut_mod, 9, movetoworkspace, 9
bind = $main_mod $mut_mod, 0, movetoworkspace, 10

# Move active window to empty workspace
bind = $main_mod $mut_mod, W, movetoworkspace, empty

# Move active window to terminal workspace
bind = $main_mod $mut_mod, T, movetoworkspace, special:term

# Move active window to game workspace
bind = $main_mod $mut_mod, G, movetoworkspace, name:Game

# Workspace Management
#-----------------------

# Go to next/previous workspace
bind = $main_mod $scope_mod, left, workspace, -1
bind = $main_mod $scope_mod, right, workspace, +1
bind = $main_mod $scope_mod, H, workspace, -1
bind = $main_mod $scope_mod, L, workspace, +1

# Move window to next/previous workspace
bind = $main_mod $scope_mod $mut_mod, left, movetoworkspace, -1
bind = $main_mod $scope_mod $mut_mod, right, movetoworkspace, +1
bind = $main_mod $scope_mod $mut_mod, H, movetoworkspace, -1
bind = $main_mod $scope_mod $mut_mod, L, movetoworkspace, +1

# System/Layout/WM Behavior
#-----------------------

# Resizing
bind = $main_mod $sys_mod, l, resizeactive, 20% 0
bind = $main_mod $sys_mod, h, resizeactive, -20% 0
bind = $main_mod $sys_mod, j, resizeactive, 0 20%
bind = $main_mod $sys_mod, k, resizeactive, 0 -20%

# Resizing (arrows)
bind = $main_mod $sys_mod, right, resizeactive, 20% 0
bind = $main_mod $sys_mod, left, resizeactive, -20% 0
bind = $main_mod $sys_mod, down, resizeactive, 0 20%
bind = $main_mod $sys_mod, up, resizeactive, 0 -20%

# Move/resize windows with main_mod + LMB/RMB and dragging
bindm = $main_mod, mouse:272, movewindow
bindm = $main_mod, mouse:273, resizewindow

# Leader-key Binds
#-----------------------

# Swap to leader-key submap
bind = $main_mod, $leader_key, submap, leader

# Everything between here and `submap = reset` is leader-key binds
# On every submap here (no matter how nested):
# - esc resets to the global map
# - backspace backs up to the previous map (like a stack)
# - catchall is a catch-all bind, it will catch any key that is not bound and reset to the global map
submap = leader, reset
    # [Q]uit active window
    bind = , Q, killactive,

    # [R]un program
    bind = , R, exec, $menu

    # [F]ile manager
    bind = , F, exec, $file_manager

    # [/] Open a terminal
    bind = , slash, exec, $terminal

    # [B]rowser
    bind = , B, exec, $browser

    # +[P]ower
    bind = , P, submap, power
    submap = power, reset
        # [L]ock
        bind = , L, exec, loginctl lock-session
        # [X] log out
        bind = , X, exit # This is basically logout
        # [S]uspend
        bind = , S, exec, systemctl suspend
        # [R]eboot
        bind = , R, exec, systemctl reboot
        # Shut [D]own
        bind = , D, exec, systemctl poweroff

        bind = , backspace, submap, leader
        bind = , escape, submap, reset
        bind = , catchall, submap, reset
    submap = leader, reset

    # +[W]indow
    bind = , W, submap, windows
    submap = windows, reset
        # [F]ull screen
        bind = , F, fullscreen
        # Toggle [H]overing (Floating)
        bind = , H, togglefloating
        # Toggle [P]seudo-floating
        bind = , P, pseudo
        # [D]iscord pop-up
        bind = , D, togglespecialworkspace, discord
        workspace = special:discord, on-created-empty:discord --enable-features=UseOzonePlatform --ozone-platform=wayland, gapsout:300 20 20 800
        # [O]bs studio pop-up
        bind = , O, togglespecialworkspace, obsstudio
        workspace = special:obsstudio, on-created-empty:obs, gapsout:400 20 20 800

        bind = , backspace, submap, leader
        bind = , escape, submap, reset
        bind = , catchall, submap, reset
    submap = leader, reset

    # +[L]ayout
    bind = , L, submap, layout
    submap = layout, reset
        # Toggle [S]plit Direction
        bind = , S, togglesplit
        # Move window to [R]oot
        bind = , R, layoutmsg, movetoroot
        # Swap S[p]lit Windows
        bind = , P, layoutmsg, swapsplit
        # P[i]n Window
        bind = , I, pin

        bind = , backspace, submap, leader
        bind = , escape, submap, reset
        bind = , catchall, submap, reset
    submap = leader, reset

    # +[U]tilities
    bind = , U, submap, utils
    submap = utils, reset
        # +[D]ictation
        bind = , D, submap, dictation
        submap = dictation, reset
            # [S]tart dictation
            bind = , S, exec, nerd-dictation begin --simulate-input-tool=WTYPE
            # [E]nd dictation
            bind = , E, exec, nerd-dictation end

            bind = , backspace, submap, utils
            bind = , escape, submap, reset
            bind = , catchall, submap, reset
        submap = utils, reset

        # +[W]allpaper
        bind = , W, submap, wallpaper
        submap = wallpaper, reset
            # [S]kip wallpaper
            bind = , S, exec, sh ~/.config/hypr/wallcycle.sh skip
            # [R]emove wallpaper
            bind = , R, exec, sh ~/.config/hypr/wallcycle.sh skip --rm

            bind = , backspace, submap, utils
            bind = , escape, submap, reset
            bind = , catchall, submap, reset
        submap = utils, reset

        # [S]creenshot
        bind = , S, exec, flameshot gui
        # [E]moji
        # bind = , E, exec, rofimoji
        # [C]olor Picker
        bind = , C, exec, hyprpicker | wl-copy -n
        # [N]otifications
        bind = , N, exec, swaync-client -t -sw
        # [V] Clipboard History Picker (v like ctrl+v)
        bind = , V, exec, tlgui cliphist

        bind = , backspace, submap, leader
        bind = , escape, submap, reset
        bind = , catchall, submap, reset
    submap = leader, reset

    bind = , backspace, submap, reset
    bind = , escape, submap, reset
    bind = , catchall, submap, reset

# No longer defining leader-key binds
submap = reset

#################
### AUTOSTART ###
#################

# exec-once = swaync
exec-once = systemctl --user start hyprpolkitagent
exec-once = swww-daemon
exec-once = sh ~/.config/hypr/wallcycle.sh daemon
exec-once = sh ~/.config/matugen/terminal_daemon.sh # Auto applies terminal colorschemes according to matugen -- works for all terminals :) Not as instant as changing terminal configs but pretty great
exec-once = waybar
exec-once = /bin/kdeconnectd
exec-once = wl-paste --watch cliphist store

#############################
### ENVIRONMENT VARIABLES ###
#############################

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24

env = XDG_CURRENT_DESKTOP,Hyprland

# Run apps in wayland! not xwayland
env = ELECTRON_OZONE_PLATFORM_HINT,auto

# Set cursor theme!
env = HYPRCURSOR_THEME,Bibata-Modern-Classic
env = HYPRCURSOR_SIZE,24

# Use qt6ct for qt themes
env = QT_QPA_PLATFORMTHEME,qt6ct
env = QT_QPA_PLATFORM,wayland
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1

#####################
### LOOK AND FEEL ###
#####################

general { 
    border_size = 1
    no_border_on_floating = false

    gaps_in = 2
    gaps_out = 4
    gaps_workspaces = 16

    col.inactive_border = rgba(00000070)
    col.active_border = rgba(00000070)

    layout = dwindle

    no_focus_fallback = false

    resize_on_border = true
    extend_border_grab_area = 15

    allow_tearing = false

    resize_corner = 0
}

decoration {
    rounding = 2

    active_opacity = 1.00
    inactive_opacity = 1.00
    fullscreen_opacity = 1.0

    shadow {
        enabled = true
        range = 30
        render_power = 3
        sharp = false
        ignore_window = true
        color = rgba(00000050)
        offset = 1 1
        scale = 1.0
    }

    dim_inactive = true
    dim_strength = 0.1
    dim_special = 0.1
    dim_around = 0.4

    blur {
        enabled = false
        size = 8
        passes = 3
        ignore_opacity = true
        new_optimizations = true
        xray = false
        noise = 0.07
        contrast = 1.2
        brightness = 1.7
        vibrancy = 0.8
        vibrancy_darkness = 0.4
        special = false
        popups = true
        popups_ignorealpha = 0.2
    }
}

animations {
    enabled = true

    bezier = gentle, 0.20, 0, 0, 1
    bezier = bounce, 0.28, 1.5, 0.54, 0.88
    bezier = slowBounce, 0.38, 1.4, 0.54, 0.92

    animation = windows, 1, 3, bounce, slide
    animation = windowsOut, 1, 3, gentle, slide
    animation = layers, 1, 3, bounce, slide top
    animation = fade, 1, 1, gentle
    animation = fadeOut, 1, 3, gentle
    animation = workspaces, 1, 2.5, slowBounce, slidefade 30%
    animation = specialWorkspace, 1, 2, bounce, slidevert 30%
}

dwindle {
    preserve_split = true
    force_split = 2
    precise_mouse_move = true
}

misc { 
    force_default_wallpaper = 0
    disable_hyprland_logo = false
    disable_splash_rendering = true
    initial_workspace_tracking = 0
    enable_anr_dialog = false
}

#############
### INPUT ###
#############

input {
    kb_layout = us
    numlock_by_default = true
    accel_profile = flat
    scroll_method = 2fg
    follow_mouse = 1
    special_fallthrough = false
    sensitivity = 0

    touchpad {
        disable_while_typing = true
        natural_scroll = true
        scroll_factor = 0.7
    }

    tablet {
        output = current
    }
}

gestures {
    workspace_swipe_distance = 300
    workspace_swipe_touch = true
    workspace_swipe_invert = true
    workspace_swipe_min_speed_to_force = 5
    workspace_swipe_cancel_ratio = 0.5
    workspace_swipe_direction_lock = false
    workspace_swipe_forever = true
}

gesture = 3, horizontal, workspace

##############################
### WINDOWS AND WORKSPACES ###
##############################

windowrulev2 = suppressevent maximize, class:.*

# Fullscreen games
windowrulev2 = fullscreen,class:steam_app*
windowrulev2 = fullscreen,class:factorio*
windowrulev2 = fullscreen, class:Terraria*

# Layerrules:

# Don't show borders on screenshots using slurp!
layerrule = noanim,selection

layerrule = ignorealpha 0.8 waybar
layerrule = blur, waybar

layerrule = ignorealpha 0.5, swaync
layerrule = blur, swaync
layerrule = animation slide right, swaync

# Don't error if the file missing
# hyprlang noerror true
# Source machine-specific configuration (things like monitor, etc. that are specific to a machine or setup.)
source = ~/.config/hypr/local.conf
# hyprlang noerror false
